<html>
<head>
    <meta charset="UTF-8" />
    <title>udevil Homepage</title>
    <!-- <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /> --> 
</head>

<body>

<center>
<table cellspacing="0" cellpadding="0" align="center" width="70%">
 <tr> 
	<td>
		<div align="left"><a href="http://ignorantguru.github.com/udevil/" border=0><h2>udevil Homepage</h2></a></div>
	</td>
	<td>
		<div align="right"><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=JUGGPTKUC2JYU"><img style="border:0;" src="donate_button.gif" alt="Make A Donation" /></a><br></div>
	</td>
</tr></table>

<br><br>
<table cellspacing="0" cellpadding="10" align="center" width="80%" border=2>
<tr><td>

<br>




<center>



<h2>udevil At A Glance</h2>
<table border=1 cellpadding="5" width="80%">

<tr>
<td valign="top"><b>About<b></td>
<td>
    udevil is a command line Linux program which mounts and unmounts removable devices without a password, shows device info, and monitors device changes.  It can also mount ISO files, nfs://, smb://, ftp://, ssh:// and WebDAV URLs, and tmpfs/ramfs filesystems.

    <ul>
	<li>Intended as a hassle-free replacement for udisks
	<li>Highly configurable &amp; security conscious
	<li>Requires no daemon running
	<li>To use it, just prefix a normal mount command with 'udevil'
	<li>Can replace udisks in the <a href="http://ignorantguru.github.com/spacefm/">SpaceFM</a> file manager and the <a href="http://igurublog.wordpress.com/downloads/script-devmon/">devmon</a> automounting daemon (devmon is included with udevil)
	<li>More <a href="#highlights">Highlights</a>
    </ul>
</td>
</tr>

<tr>
<td valign="top"><b>Depends<b></td>
<td>
	<ul>
		<li>udev <i><b>or</i></b> eudev
		<li>glib
	</ul>
	udevil (&amp; SpaceFM) can be used completely <i><b>without</b></i> systemd, consolekit, policykit, dbus, udisks, gvfs &amp; fuse (although it can coexist with any of these).
</td>
</tr>

<tr>
<td valign="top"><b>Install<b></td>
<td>
	<ul>
		<li><a href="https://github.com/IgnorantGuru/spacefm/wiki/Distros">Packages for your distro</a>
		<li>Use the <a href="#installer">Self-Extracting Installer</a>
		<li>Download the source from <a href="https://github.com/IgnorantGuru/udevil/releases">Github</a>
		<li><b>IMPORTANT:</b> <a href="#post">Post-Installation Steps</a>
	</ul>
</td>
</tr>

<tr>
<td valign="top"><b>Docs<b></td>
<td>
	<ul>
		<li><b><a href="udevil--help.html">Usage</a> - udevil's command line</b>
		<li><a href="udevil.conf.txt">udevil.conf</a> - How to configure udevil
		<li>Latest <a href="https://github.com/IgnorantGuru/udevil/blob/master/README">README</a> file
		<li>Help <a href="https://github.com/IgnorantGuru/spacefm/wiki/Translate">Translate</a>
		<li><a href="https://github.com/IgnorantGuru/udevil/blob/master/COPYING">License</a>
	</ul>
</td>
</tr>

<tr>
<td valign="top"><b>Sites<b></td>
<td>
	<ul>
		<li><b><a href="news.html">News</a> - The latest news on udevil development and releases</b>
		<li><a href="https://sourceforge.net/p/spacefm/discussion/general/">Official Forum</a> - Discuss any aspect of udevil or SpaceFM
		<li><a href="https://github.com/IgnorantGuru/udevil/wiki/">Wiki</a>
		<li>IRC Channel -  #spacefm on <a href="http://freenode.net/irc_servers.shtml">irc.freenode.net</a>
		<li><a href="https://github.com/IgnorantGuru/udevil/issues">Bugs &amp; Requests</a> - For issue priorities see <a href="https://github.com/IgnorantGuru/udevil/milestones">Milestones</a>.
		<li><a href="https://github.com/IgnorantGuru/udevil/commits/master">Master code repo</a> (release version)
		<li><a href="https://github.com/IgnorantGuru/udevil/commits/next">Next code repo</a> (rolling release)
	</ul>
</td>
</tr>

</table>
</center>


<br>
<hr>
<br>

<h3><a name="highlights">Highlights</a></h3>
<ul>
    <li>Lightweight -  Written in C with libudev and glib - no dependency on udisks or gvfs
    <li>Users can specify custom mount points and mount options
    <li>Optional user mounting of nfs://, smb://, ftp://, ssh:// and WebDAV network URLs with support for username, password, port, and any other configured options
    <li>Optional user mounting of image files (ISO, etc)
    <li>Uses mount's existing command line usage - just prefix your mount command with 'udevil'.  Also supports udisks v1 and v2 command line usage
    <li>Flexible - Admins can easily adjust allowed users, groups, fstypes, devices, and networks, and set default mount options and allowed mount options for each fstype, with exceptions for special users
    <li>Extensible - Allows admins to use additional custom authentication and notification scripts
    <li>Secure - Designed to limit user actions to only what you want enabled, plus easily log all system-wide uses of udevil
    <li>Detailed errors and verbose commands for quick troubleshooting
    <li>Works as <a href="http://ignorantguru.github.com/spacefm/">SpaceFM</a>'s mount/unmount command, replacing need for pmount or udisks
    <li>Includes and works as a udisks v1 replacement for the <a href="http://igurublog.wordpress.com/downloads/script-devmon/">devmon</a> automounting daemon
</ul>

<h3>Limitations</h3>
<ul>
	<li>udevil does not handle encrypted devices automatically
</ul>
<br>




<br><br><br>




<hr>
<a name="installer">&nbsp;</a>
<p><h3>Installer</h3>

<p>A self-extracting installer is available in <a href="https://github.com/IgnorantGuru/udevil/tree/pkg">Downloads</a> (click on a file and click View Raw to download).  The installer MUST be run in a terminal.  It automatically builds and installs, and should work with any recent distro.  Run it like this:
<p>
<table bgcolor="#d0d4d7" width="100%" border="1"><tr><td><pre><font color="#000000">bash udevil-x.x.x-installer.sh

# or to see options:

bash udevil-x.x.x-installer.sh --help
</font></pre></td></tr></table>

<p>The installer requires the build dependencies listed in the <a href="https://github.com/IgnorantGuru/udevil/blob/master/README">README</a> file.  Build dependencies include:  (package names may vary on your distro)
<blockquote><i>libglib2.0-0 libglib2.0-dev libudev0 (>=143) libudev-dev autotools-dev build-essential fakeroot intltool pkg-config</i></blockquote>

<p>Also recommended for network support: <i>cifs-utils curlftpfs sshfs davfs2</i>

<p>Also recommended if using devmon: <i>eject</i> <i>zenity</i>

<p>If any dependencies are missing, examine the error, install missing packages, and try again.

<p>To reinstall or upgrade, just run the latest installer again.<BR>

<p>For easy manual build instructions please see the <a href="https://github.com/IgnorantGuru/udevil/blob/master/README">README</a> file.

<p>To authenticate downloads see <a href="http://ignorantguru.github.com/udevil/udevil.SHA256.txt">authentication instructions</a>.

<p>NOTE: Also see <a href="#post">Post Installation</a> steps below.

<br>
<br>
<hr>

<a name="post">&nbsp;</a>
<p><h3>Post Installation</h3>

<b>Kernel Polling</b>

<p>Older Distros: You may need to enable kernel polling for device media to be detected by udevil.  See the <a href="#polling">Enable Kernel Polling</a> section below.

<p><b>Networks and Files</b>

<p>By default, /etc/udevil/udevil.conf is set to allow only local fileystems and ISO files to be mounted, with mounting of networks disallowed.  To allow networks and files to be mounted, in /etc/udevil/udevil.conf set:

<pre>
    allowed_types = $KNOWN_FILESYSTEMS, file, cifs, nfs, curlftpfs, sshfs, davfs
</pre>

You may also need to install <a href="http://linuxconfig.org/mount-remote-ftp-directory-host-locally-into-linux-filesystem">curlftpfs</a> or <a href="http://www.techrepublic.com/article/mount-ftp-volumes-locally-with-ftpfs/5031896">ftpfs</a> (ftp://), cifs-utils or smbfs (smb://), sshfs (ssh://), and <a href="http://linux.die.net/man/8/mount.davfs">davfs2</a> (http://).

<p><b>NTFS-3G</b>

<p>If local ntfs filesystems aren't mounted writable, you may need to configure your system to mount ntfs with ntfs-3g (on some distros this is already done).  For example:
<pre>
    sudo ln -s /sbin/mount.ntfs-3g /sbin/mount.ntfs

    # OR if mount.ntfs-3g is located in /usr/bin:
    sudo ln -s /usr/bin/mount.ntfs-3g /usr/bin/mount.ntfs
</pre>

<p><b>Set SUID</b>

<p>After installing udevil, /usr/bin/udevil should have the suid bit already set.  If not, set it like this:
<pre>
    sudo chown root:root /usr/bin/udevil
    sudo chmod u+s,go-s,ugo+x /usr/bin/udevil
    ls -l /usr/bin/udevil
        -rwsr-xr-x 1 root root 226625 May 22 08:13 /usr/bin/udevil
</pre>

OR, to restrict execution of udevil to the 'plugdev' group only:
<pre>
    sudo chown root:plugdev /usr/bin/udevil
    sudo chmod u+s,go-s,o-x /usr/bin/udevil
    ls -l /usr/bin/udevil
        -rwsr-xr-- 1 root plugdev 226625 May 22 08:13 /usr/bin/udevil
</pre>

OR, if you don't want to use udevil for mounting, you can unset suid:
<pre>
    sudo chown root:root /usr/bin/udevil
    sudo chmod ugo-s,ugo+x /usr/bin/udevil
    ls -l /usr/bin/udevil
        -rwxr-xr-x 1 root root 226625 May 22 08:13 /usr/bin/udevil
</pre>
You can also limit users and groups by editing <a href="udevil.conf.txt">/etc/udevil/udevil.conf</a>

<br>
<br>
<hr>
<a name="polling">&nbsp;</a>
<p><h3>Enable Kernel Polling</h3>

<p>OLDER DISTROS:  You may need to enable kernel polling for device media to be detected by udevil.  For example, if you insert a CD and udevil's monitor command doesn't report a change to the device, or udevil doesn't see a filesystem on the device, this is a symptom that kernel polling is not enabled.

<p>Kernel polling is a newer feature of the Linux kernel and udev, so some distros may not yet have it enabled by default.  To use kernel polling, your Linux kernel may need to be <b>2.6.38 or newer</b>, and udev may need to be <b>version 173</b> or newer.

<p>To determine if kernel polling is enabled:
<pre>
    cat /sys/module/block/parameters/events_dfl_poll_msecs
    cat /sys/block/sr0/events_poll_msecs
</pre>

If you get 0 or -1 from both of those commands, kernel polling may be disabled.

<p><b>To enable kernel polling permanently</b> (survives a reboot), add the following command to your <b>/etc/rc.local</b> file (anywhere before the 'exit' line in that file):
<pre>
    echo 2000 > /sys/module/block/parameters/events_dfl_poll_msecs
</pre>

Any number between 2000 and 5000 (milliseconds) should be reasonable - the higher 5000 means poll every 5 seconds, which is less overhead but a little slower.

<p><b>OR</b> pass this option to the kernel boot command line in grub:
<blockquote>
    <i>block.events_dfl_poll_msecs=2000</i>
</blockquote>

<p><b>OR</b> add a udev rule to enable kernel polling on removable devices:<br>
<blockquote><code>
    echo 'ACTION=="add", ATTR{removable}=="1", ATTR{events_poll_msecs}=="-1", ATTR{events_poll_msecs}="2000"' > /etc/udev/rules.d/61-removable-storage-polling.rules
</code></blockquote>

<p>A reboot will be required for the above changes to take effect, or...

<p><b>To enable kernel polling temporarily and immediately</b>, enable common polling for the block module:
<pre>
    sudo bash -c 'echo 2000 > /sys/module/block/parameters/events_dfl_poll_msecs'
</pre>

<p><b>OR</b> you can enable polling just for a single device like this (/dev/sr0 in this example):
<pre>
    sudo bash -c 'echo 2000 > /sys/block/sr0/events_poll_msecs'
</pre>

This change should be immediate - media will be detected.  However, the above change will be lost when you reboot.

<p>References:<br>
<a href="http://www.mail-archive.com/lfs-dev@linuxfromscratch.org/msg15714.html">linuxfromscratch.org</a><br>
<a href="http://blogs.gentoo.org/mgorny/2011/06/20/uam-can-now-mount-cds-and-dvds/">uam-can-now-mount-cds-and-dvds</a><br>
<a href="https://bugs.archlinux.org/task/25609">bugs.archlinux.org</a><br>
<a href="http://unix.stackexchange.com/questions/38582/udev-triggers-are-not-firing-on-insert-of-cf-card-into-usb-card-reader-anymore">unix.stackexchange.com</a><br>



</td></tr></table>
<br><br><br>


<table cellspacing="0" cellpadding="0" align="center" width="75%">
 <tr> 
	<td>
		<div align="left"><i>Updated 2018-Jan-27</i></div>
	</td>
	<td>
		<div align="left"><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=JUGGPTKUC2JYU"><img style="border:0;" src="donate_button.gif" alt="Make A Donation" /></a><br></div>
	</td>
	<td>
		<div align="right"><a href="https://github.com/IgnorantGuru">Contact</a></div>
	</td>
</tr></table>


<br>
</center>
</body></html>
